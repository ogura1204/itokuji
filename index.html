<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>町家の日 AR（サイズスキャン版）</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
      body { margin: 0; overflow: hidden; font-family: "Yu Mincho", serif; }
      #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a1a1a; z-index: 99999; display: flex; justify-content: center; align-items: center; }
      .loader { border: 2px solid rgba(255,255,255,0.1); border-left-color: #fff; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
      #footer-frame { position: fixed; bottom: 0; left: 0; width: 100%; height: 10%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 9999; }
      .f-text { color: white; font-size: 12px; }
    </style>
  </head>
  <body>

    <div id="loading"><div class="loader"></div></div>
    <div id="footer-frame"><div class="f-text">Scanning Size...</div></div>

    <a-scene 
      mindar-image="imageTargetSrc: ./targets-2.mind; uiError:yes; uiLoading:no;" 
      color-space="sRGB" 
      renderer="colorManagement: true, physicallyCorrectLights" 
      vr-mode-ui="enabled: false" 
      device-orientation-permission-ui="enabled: false">
      
      <a-assets>
        <img id="img-pers-1" src="./pers_1.png" />
        <a-asset-item id="model-glb" src="./model.glb"></a-asset-item>
        <img id="img-magic-circle" src="./magic_circle.png" />
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-light type="ambient" color="#BBB" intensity="1"></a-light>
      <a-light type="directional" color="#FFF" intensity="1.5" position="-0.5 1 1"></a-light>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-image id="ar-image-1" src="#img-pers-1" position="0 0 0" width="1"></a-image>
      </a-entity>

      <a-entity id="target-pop2" mindar-image-target="targetIndex: 1">
        
        <a-box color="blue" opacity="0.5" position="0 0 0" scale="0.5 0.5 0.5"></a-box>

        <a-entity gltf-model="#model-glb" 
                  position="0 0 0" 
                  rotation="0 0 0"
                  animation="property: scale; from: 0.1 0.1 0.1; to: 50 50 50; dur: 5000; dir: alternate; loop: true; easing: linear">
        </a-entity>

      </a-entity>

      <a-entity id="target-outside" mindar-image-target="targetIndex: 2"></a-entity>

      <a-entity id="target-card" mindar-image-target="targetIndex: 3">
        </a-entity>

    </a-scene>

    <script>
      const loadingDiv = document.getElementById('loading');
      const sceneEl = document.querySelector('a-scene');
      sceneEl.addEventListener('arReady', () => {
        loadingDiv.style.display = 'none';
      });
      // その他のスクリプトは省略なしで動作します
    </script>
  </body>
</html>
